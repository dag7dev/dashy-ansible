---
- name: Deploy Dashy App
  hosts: all
  become: true
  roles:
    - geerlingguy.nodejs
  tasks:
    - name: Clone Dashy repository
      git:
        repo: https://github.com/Lissy93/dashy.git
        dest: /home/nephila/dashy  
        
    - name: Install "yarn" node.js package globally.
      community.general.npm:
        name: yarn
        global: true
      
    - name: Install dependencies with yarn
      command: yarn
      args:
        chdir: /home/nephila/dashy  
      
    - name: Build the app with yarn
      command: yarn build
      args:
        chdir: /home/nephila/dashy
      
    - name: Start the app with yarn
      command: yarn start
      args:
        chdir: /home/nephila/dashy
      
